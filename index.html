<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<title>UBT Simulasi</title>
<style>
*{ box-sizing:border-box; margin:0; padding:0; font-family:Arial, Helvetica, sans-serif; }
body{ height:100vh; display:flex; justify-content:center; align-items:center;
  background:linear-gradient(rgba(0,0,0,.35),rgba(0,0,0,.35)),
  url("https://raw.githubusercontent.com/airnetcso/eps/main/image/bg1.jpg") center/cover no-repeat;
}
.login-box{
  width:100%; max-width:360px; background:rgba(255,255,255,0.25);
  padding:30px 25px; text-align:center; backdrop-filter:blur(8px);
  border-radius:14px; box-shadow:0 10px 30px rgba(0,0,0,0.4);
}
.login-box h2{
  margin-bottom:20px; color:#fff; font-size:24px;
  text-shadow:0 2px 8px rgba(0,0,0,0.7);
}
input, select, button{
  width:100%; padding:14px; margin-bottom:15px;
  font-size:16px; border-radius:8px; border:none;
}
input, select{ outline:none; background:rgba(255,255,255,0.15); color:#fff; }
input::placeholder{ color:rgba(255,255,255,0.7); }
button{ background:#2563eb; color:#fff; font-weight:bold; cursor:pointer; transition:0.3s; }
button:hover{ background:#1e40af; transform:translateY(-2px); }
#error-msg{ color:#ff6b6b; font-weight:bold; margin-top:10px; font-size:14px; min-height:18px; }
.hidden{ display:none !important; }
.copyright{ position:fixed; bottom:12px; width:100%; text-align:center; font-size:12px; color:rgba(255,255,255,0.85); letter-spacing:0.5px; }
</style>
</head>
<body>

<!-- LOGIN PAGE -->
<div class="login-box" id="loginDiv">
  <h2>LOGIN UBT SIMULASI</h2>
  <input id="username" placeholder="Username / 이름">
  <input id="password" type="password" placeholder="Password / 비밀번호">
  <select id="paket">
    <option value="1">TRYOUT 01</option>
    <option value="2">TRYOUT 02</option>
    <option value="3">TRYOUT 03</option>
  </select>
  <button onclick="login()">LOGIN / 로그인</button>
  <div id="error-msg"></div>
</div>

<!-- QUIZ SIMULASI PAGE -->
<div class="login-box hidden" id="quizDiv">
  <h2>UBT SIMULASI</h2>
  <p id="welcome" style="color:#fff; font-weight:bold; font-size:18px;"></p>
  <p style="color:#fff;">Paket yang dipilih: <span id="selectedPaket"></span></p>
  <button onclick="finishQuiz()">Selesai Quiz (Simulasi)</button>
</div>

<div class="copyright">
  © 2026 Denzuka - Kim Jongun. All Rights Reserved.
</div>

<script>
// URL Google Sheet /koka
const SPREADSHEET_URL = "https://script.google.com/macros/s/AKfycby4n_2wq6NSRDcKZ5h_EK52P6unhy4hcDKg_svaaXjN5K2kPQXOEYouvEtnQVIKMhHamA/exec";

const users = [
  {username:"siswa01",password:"12345",role:"user"},
  {username:"windi",password:"Windi2000",role:"user"},
  {username:"rismaya97",password:"bahasakorea",role:"user"},
  {username:"sita77",password:"minyooki",role:"user"},
  {username:"Aini185",password:"Doraemon",role:"user"},
  {username:"Hangeulfei",password:"studykorea02",role:"user"},
  {username:"Hamdan106",password:"Fukuo106",role:"user"},
  {username:"Heri",password:"heri99",role:"user"},
  {username:"admin",password:"admin123",role:"admin"}
];

// Login function
function login(){
  const err = document.getElementById("error-msg");
  err.innerText = "";
  const u = document.getElementById("username").value.trim();
  const p = document.getElementById("password").value.trim();
  const paket = document.getElementById("paket").value;
  const user = users.find(x => x.username === u && x.password === p);
  if(!user){ err.innerText = "Username atau password salah!"; return; }

  localStorage.setItem("user",u);
  localStorage.setItem("paket",paket);

  if(user.role === "admin"){ location.href="https://airnetcso.github.io/admin/"; return; }

  document.getElementById("loginDiv").classList.add("hidden");
  document.getElementById("quizDiv").classList.remove("hidden");
  document.getElementById("welcome").innerText = "Halo, " + u;
  document.getElementById("selectedPaket").innerText = "TRYOUT " + ("0"+paket).slice(-2);
}

// Kirim skor ke Sheet (hanya saat quiz selesai)
function sendScoreToSheet(username, paket, score){
  const kodeMapping = {"1":"H050126","2":"R43213","3":"Z21985"};
  const data = {
    username: username,
    kodeSoal: kodeMapping[paket] || "UNKNOWN",
    jenisAplikasi: "QUIZ",
    skor: score,
    persentase: Math.round(score),
    catatan: ""
  };
  fetch(SPREADSHEET_URL,{
    method:"POST",
    headers:{ "Content-Type":"application/json" },
    body:JSON.stringify(data)
  })
  .then(r=>r.json())
  .then(res=>console.log("Skor berhasil dikirim:", res))
  .catch(e=>console.error("⚠️ Gagal mengirim skor ke Google Sheet. Cek console.", e));
}

// Quiz selesai (simulasi)
function finishQuiz(){
  const username = localStorage.getItem("user");
  const paket = localStorage.getItem("paket");
  const score = Math.floor(Math.random()*41)+60; // 60–100
  let results = JSON.parse(localStorage.getItem("results")||"[]");
  results.push({name:username,paket:Number(paket),score:score});
  localStorage.setItem("results",JSON.stringify(results));
  sendScoreToSheet(username,paket,score);
  alert("Quiz selesai! Skor: "+score);
}
</script>
</body>
</html>
