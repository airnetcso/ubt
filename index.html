<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Login CBT UBT</title>
  <style>
    *{ box-sizing:border-box; font-family:Arial, Helvetica, sans-serif }
    body{ margin:0; height:100vh; display:flex; justify-content:center; align-items:center; background:linear-gradient(rgba(0,0,0,.35),rgba(0,0,0,.35)), url("https://raw.githubusercontent.com/airnetcso/eps/main/image/bg1.jpg") center/cover no-repeat; }
    .login-box{ width:340px; background:rgba(255,255,255,.3); padding:30px 25px; text-align:center; backdrop-filter:blur(6px); border-radius:10px; box-shadow:0 8px 32px rgba(0,0,0,.2); }
    .login-box h2{ margin-bottom:20px; color:#fff; font-size:24px; }
    input, select, button{ width:100%; padding:12px; margin-bottom:12px; font-size:14px; border-radius:6px; border:none; outline:none; }
    input:focus, select:focus{ box-shadow:0 0 0 2px #60a5fa; }
    button{ background:#2563eb; color:#fff; cursor:pointer; font-weight:bold; transition:background .3s; }
    button:hover{ background:#1e40af; }
    #error-msg{ color:#ff0000; font-weight:bold; margin-top:10px; font-size:13px; min-height:20px; }
    .copyright{ position:fixed; bottom:12px; width:100%; text-align:center; font-size:12px; color:rgba(255,255,255,0.85); letter-spacing:0.5px; }
    .info{ color:#fff; font-size:12px; margin-top:15px; }
  </style>
</head>
<body>
  <div class="login-box">
    <h2>LOGIN UBT</h2>
    <input id="username" placeholder="Username / 이름" autofocus>
    <input id="password" type="password" placeholder="Password / 비밀번호">
    <select id="paket">
      <option value="1">TRYOUT 01</option>
      <option value="2">TRYOUT 02</option>
      <option value="3">TRYOUT 03</option>
    </select>
    <button onclick="login()">LOGIN / 로그인</button>
    <div id="error-msg"></div>

  </div>
  <div class="copyright">
    © 2026 Denzuka - Kim Jongun. All Rights Reserved.
  </div>

  <script>
    const SPREADSHEET_URL = "https://script.google.com/macros/s/AKfycbyfCZ5YNQHDLyKWatqj-diL8tXRRwXBKfJaaYMqcqoShABYy4Gx6QpexPOB_MkZwpIwLw/exec";

    const users = [
      {username:"siswa01",password:"12345"},
      {username:"windi",password:"Windi2000"},
      {username:"windi",password:"Windi2000"},
      {username:"rismaya97",password:"bahasakorea"},
      {username:"sita77",password:"minyooki"},
      {username:"Aini185",password:"Doraemon"},
      {username:"Hangeulfei",password:"studykorea02"},
      {username:"Hamdan106",password:"Fukuo106"},
      {username:"Heri",password:"heri99"},
	    {username:"hanarizka",password:"ungkihana24!"},
      {username:"Fikrisurya",password:"464646"},
      {username:"Mutiara2003",password:"Mutiara14"},
      {username:"wantikas",password:"200022"},
      {username:"Dininidia",password:"dininidia11"},
      {username:"Hangeulfei",password:"studykorea02"},
      {username:"kaniarostayuni9",password:"Kania1313"},
      {username:"Dikisetiawan07",password:"Diki2709"},
      {username:"Aisyah18",password:"Aisyah18."},
      {username:"Dininidia",password:"dininidia11"},
      {username:"Hangeulfei",password:"studykorea02"},
      {username:"Rizka2026",password:"butterfly24"},
      {username:"Zhafif07",password:"20060722"},
      {username:"Hangeulfei",password:"studykorea02"},
      {username:"Hamdan106",password:"Fukuo106"},
      {username:"Heri",password:"heri99"},
      {username:"rismaya97",password:"bahasakorea"},
      {username:"sita77",password:"minyooki"},
      {username:"Aini185",password:"Doraemon"},
      {username:"Hangeulfei",password:"studykorea02"},
      {username:"Hamdan106",password:"Fukuo106"},
      {username:"Heri",password:"heri99"},
      {username:"Dininidia",password:"dininidia11"},
      {username:"Hangeulfei",password:"studykorea02"},
      {username:"kaniarostayuni9",password:"Kania1313"},
      {username:"Dikisetiawan07",password:"Diki2709"},
      {username:"Aisyah18",password:"Aisyah18."},
      {username:"Dininidia",password:"dininidia11"},
      {username:"Hangeulfei",password:"studykorea02"},
      {username:"Rizka2026",password:"butterfly24"},
      {username:"Zhafif07",password:"20060722"},
      {username:"Hangeulfei",password:"studykorea02"},
      {username:"wantikas",password:"200022"},
      {username:"Heri",password:"heri99"},
      {username:"admin",password:"admin123",role:"admin"}
    ];

    function checkStorage(){
      try{ localStorage.setItem("test","ok"); localStorage.removeItem("test"); return true; }catch(e){ return false; }
    }

    function login(){
      const err = document.getElementById("error-msg");
      err.innerText = "";
      if(!checkStorage()){ err.innerText = "Browser memblokir localStorage. Gunakan mode normal."; return; }
      
      const u = document.getElementById("username").value.trim();
      const p = document.getElementById("password").value.trim();
      const paket = document.getElementById("paket").value;
      
      if (!u || !p) { err.innerText = "Username & password wajib diisi!"; return; }

      const user = users.find(x => x.username === u && x.password === p);
      if(!user){ err.innerText = "Username atau password salah!"; return; }
      
      if(Number(paket) > 1){
        const results = JSON.parse(localStorage.getItem("results") || "[]");
        const prev = results.find(r => r.name === u && Number(r.paket) === Number(paket) - 1);
        if(!prev || Number(prev.score) < 80){ 
          err.innerText = "Harus lulus paket sebelumnya dengan nilai minimal 80"; 
          return; 
        }
      }
      
      localStorage.setItem("login","true");
      localStorage.setItem("user",u);
      localStorage.setItem("paket",paket);
      
      if(user.role === "admin") {
        location.href = "https://airnetcso.github.io/admin/";
      } else {
        location.href = "dashboard.html";
      }
    }

    // Enter untuk login
    document.addEventListener("keypress", function(e) {
      if (e.key === "Enter") login();
    });
  </script>
</body>
</html>
